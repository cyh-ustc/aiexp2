 http www hughes family org bugzilla show bug cgi id summary img tag based rules product spamassassin version unspecified platform other os version other status new severity enhancement priority p component eval tests assignedto spamassassin devel example sourceforge net reportedby matt nightrealms com inspired by complaints about all image or mostly image spam that s getting by sa i ve cooked up three sets of rules that analyze the use of img tags in html one that looks at the total area of all of the images in the message t html image area one that looks at the total number of images in the message t html num imgs and one that looks at the longest total run of consecutive images t html consec img the total area of all images is rather easy to compute inside of html html tests if an img tag has both the width and height properties then multiply them together and add the result to the running total overall spam nonspam s o rank score name all messages all messages as t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area t html image area spam of all rules with s the total number of img tags is really easy to do t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs t html num imgs spam of all rules with s o i figured that spam that is made up of only images is going to only have img tags interspersed with table paragraph and linebreak tags and some whitespace so there would be a lot of img tags with no plain text non whitespace between them so i defined consecutive img tags to be ones with no text between them and looked at the longest run of consecutive imgs within a message this one seems to do pretty good because in my non spam corpus there s only a handful of messages with img runs larger than two t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs t html consec imgs spam of all rules with s o next i m going to see if there s any meta rules i can make that will reduce the fp rate for low s o rules you are receiving this mail because you are the assignee for the bug or are watching the assignee this sf net email is sponsored by thinkgeek welcome to geek heaven http thinkgeek com sf spamassassin devel mailing list spamassassin devel lists sourceforge net https lists sourceforge net lists listinfo spamassassin devel 